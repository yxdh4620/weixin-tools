// Generated by CoffeeScript 1.8.0
(function() {
  var WeixinTools, config, env, jsapi_ticket, media, menus, news_material_id, noncestr, options, p, should, signArgs, signature, timestamp, token, url, wxt, _;

  should = require("should");

  p = require("commander");

  env = p.environment || 'development';

  _ = require('underscore');

  config = require('../config/config')[env];

  menus = config.menus;

  noncestr = "Wm3WZYTPz0wzccnW";

  jsapi_ticket = "sM4AOVdWfPE4DxkXGEs8VMCPGGVi4C3VM0P37wVUCFvkVAy_90u5h9nbSlYy3-Sl-HhTdfl2fzFy1AOcHKP7qg";

  timestamp = "1414587457";

  url = "http://mp.weixin.qq.com?params=value";

  signature = '0f9de62fce790f9a083d5c99e95740ceb90c27ed';

  signature = '0f9de62fce790f9a083d5c99e95740ceb90c27ed';

  signArgs = {
    noncestr: "Wm3WZYTPz0wzccnW",
    jsapi_ticket: "sM4AOVdWfPE4DxkXGEs8VMCPGGVi4C3VM0P37wVUCFvkVAy_90u5h9nbSlYy3-Sl-HhTdfl2fzFy1AOcHKP7qg",
    timestamp: "1414587457",
    url: "http://mp.weixin.qq.com?params=value"
  };

  WeixinTools = require("../weixin_tools");

  options = {
    appid: config.appid,
    secret: config.secret,
    payOptions: config.payOptions,
    jsApiList: config.jsApiList
  };

  wxt = new WeixinTools(options);

  media = null;

  token = null;

  news_material_id = null;

  token = {
    access_token: 'y79VO8AyiRJzM3yqTVHTexgEoaX_Z91C5_EX_qTc0JqH7BxLj7ibMAAJmTnCFuzRUQuJAZVF958HlSPZiJQMFaxlREE_TB6PGDWOlI5PkqhzaigyZPLSaEs3LtSfzv4rNINeAGAWRW',
    expires_in: 7200
  };

  describe("test weixin_tools", function() {
    before(function() {});
    return describe("material", function() {
      it("add image material", function(done) {
        var filename;
        filename = "/Users/user/Downloads/05AtKBTyih_im1oj2sw_myImage.png";
        return wxt.addImageMaterial(token.access_token, filename, function(err, data) {
          if (err != null) {
            console.log(err);
          }
          console.dir(data);
          media = data;
          return done();
        });
      });
      it("add news material", function(done) {
        var news;
        news = [
          {
            title: "test",
            thumb_media_id: media.media_id,
            author: 'GamaLabs',
            digest: '只是一个简单的测试',
            show_cover_pic: 1,
            content: "拯救世界一个测试上传的数据<br/>\n<img class=\"rich_media_thumb\" id=\"js_cover\" onerror=\"this.parentNode.removeChild(this)\"\ndata-backsrc=\"" + media.url + "\" data-s=\"300,640\" src=\"" + media.url + "\">",
            content_source_url: ""
          }, {
            title: "test2",
            thumb_media_id: media.media_id,
            author: 'GamaLabs',
            digest: '只是一个简单的测试2',
            show_cover_pic: 1,
            content: "拯救世界一个测试上传的数据2<br/>\n<img class=\"rich_media_thumb\" id=\"js_cover\" onerror=\"this.parentNode.removeChild(this)\"\ndata-backsrc=\"" + media.url + "\" data-s=\"300,640\" src=\"" + media.url + "\">",
            content_source_url: ""
          }
        ];
        return wxt.addNewsMaterial(token.access_token, news, function(err, data) {
          if (err != null) {
            console.log(err);
          }
          console.dir(data);
          news_material_id = data.media_id;
          return done();
        });
      });
      return it("delete material", function(done) {
        news_material_id = 'VXXwGi7THPUdu5zdHXKlaHmbf-rz15UweMgvmNX1y64';
        return wxt.deleteMaterial(token.access_token, news_material_id, function(err, data) {
          if (err != null) {
            console.log(err);
          }
          console.dir(data);
          return done();
        });
      });
    });
  });

}).call(this);
